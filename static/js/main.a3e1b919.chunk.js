(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(e,t,a){e.exports=a.p+"static/media/undraw_making_art_759c.7a6edf59.svg"},31:function(e,t,a){e.exports=a.p+"static/media/undraw_image_upload_wqh3.771e1a7c.svg"},32:function(e,t,a){e.exports=a.p+"static/media/undraw_safe_bnk7.c0bcd0b8.svg"},33:function(e,t,a){e.exports=a.p+"static/media/carlos.f756d44b.png"},34:function(e,t,a){e.exports=a.p+"static/media/daute.eb1ecf91.png"},37:function(e,t,a){e.exports=a(60)},43:function(e,t,a){},48:function(e,t,a){},50:function(e,t,a){},54:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(28),i=a.n(o),s=(a(43),a(15)),l=a(22),c=(a(48),function(){return r.a.createElement("nav",{className:"header__nav"},r.a.createElement(l.HashLink,{to:"/"},r.a.createElement("h1",{className:"nav__logo"},"Stransfer")),r.a.createElement("div",{className:"collapsable-nav-list"},r.a.createElement("input",{type:"checkbox",id:"collapse-nav",hidden:!0}),r.a.createElement("label",{"aria-hidden":"true",className:"collapse-nav-list-btn",htmlFor:"collapse-nav"},r.a.createElement("span",null)," ",r.a.createElement("span",null)," ",r.a.createElement("span",null)),r.a.createElement("ul",{className:"nav__nav-list"},r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement(l.HashLink,{to:"/#about-section"},"About Stransfer")),r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement(l.HashLink,{to:"/app"},"App")),r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement(l.HashLink,{to:"/#about-us-section"},"About Us")),r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement("a",{href:"https://github.com/DauteRR/StyleTransfer",target:"_blank",rel:"noopener noreferrer"},"Github")))))}),m=(a(50),a(30)),u=a.n(m),d=a(31),h=a.n(d),p=a(32),f=a.n(p),g=a(33),v=a.n(g),b=a(34),y=a.n(b),_=a(24),w=a(25),E=a(6),N=a.n(E),k=a(12),j=a(7),S=a(8),I=a(11),R=a(9),O=a(10),x=a(19),T=document.createElement("canvas");function D(e,t){var a=t.width,n=t.height;T.width=a,T.height=n;var r=T.getContext("2d");return r?(r.drawImage(e,0,0,a,n),new Promise(function(e,t){return T.toBlob(function(a){return a?e(a):t()})})):Promise.reject()}function L(e,t){try{t.srcObject=e}catch(a){t.src=URL.createObjectURL(e)}finally{return new Promise(function(e){return t.addEventListener("loadedmetadata",function(){return e(t)},{once:!0})})}}function M(e){return e instanceof HTMLVideoElement?e.videoWidth/e.videoHeight:e.width/e.height}var C={width:300,height:300};function W(e){var t=Object(w.a)({},C);return e<1?t.width*=e:t.height/=e,t}a(54);var P=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(I.a)(this,(e=Object(R.a)(t)).call.apply(e,[this].concat(r)))).state={stream:null,isRecording:!1,errorMessage:""},a._videoRef=null,a._setVideoRef=function(e){return a._videoRef=e},a._loadStream=function(){var e=Object(k.a)(N.a.mark(function e(t){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a._videoRef){e.next=6;break}return e.next=3,L(t,a._videoRef);case 3:a.setState({stream:t,isRecording:!0,errorMessage:""}),e.next=7;break;case 6:a.setState({stream:null,isRecording:!1,errorMessage:"Unable to get the video element. Must be a bug, this should never happen D:"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._takePhoto=Object(k.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a._videoRef,a.state.isRecording&&t){e.next=3;break}return e.abrupt("return",Promise.reject());case 3:a.props.onNewPhoto(t);case 4:case"end":return e.stop()}},e,this)})),a}return Object(O.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(this._loadStream).catch(function(t){e.setState({isRecording:!1,errorMessage:"Access to camera not granted"})})}},{key:"componentWillUnmount",value:function(){var e=this.state.stream;e&&function(e){Object(_.a)(e.getTracks()).forEach(function(e){return e.stop()})}(e)}},{key:"render",value:function(){if(this.state.errorMessage)return r.a.createElement("div",{className:"camera-container"},r.a.createElement("p",{className:"camera-container__error-message"},this.state.errorMessage));var e=C;this._videoRef&&this._videoRef.videoWidth>0&&this._videoRef.videoHeight>0&&(e=W(M(this._videoRef)));return r.a.createElement("div",{className:"camera-container"},r.a.createElement("div",{className:"camera-container__camera"},r.a.createElement("video",{ref:this._setVideoRef,autoPlay:!0,width:C.width,height:C.height,role:"application","aria-label":"Camera",style:{maxWidth:"".concat(e.width,"px"),maxHeight:"".concat(e.height,"px")}},'Cannot show the camera. Maybe it is because this browser doesn\'t support the HTML5 "video" element')),r.a.createElement("button",{className:"camera-container__button",onClick:this._takePhoto,"aria-label":"Take photo",title:"Take photo"}))}}]),t}(n.Component),U=(a(56),function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(I.a)(this,(e=Object(R.a)(t)).call.apply(e,[this].concat(o)))).canvasRef=r.a.createRef(),a.imageRef=r.a.createRef(),a.state={isImageLoaded:!1},a.onImageLoad=function(){var e=a.getCanvasElement().getContext("2d");e&&(e.drawImage(a.getImageElement(),0,0,a.props.width,a.props.height),a.setState({isImageLoaded:!0}))},a}return Object(O.a)(t,e),Object(S.a)(t,[{key:"getImageElement",value:function(){var e=this.imageRef.current;if(!e)throw new Error("Image reference error");return e}},{key:"getCanvasElement",value:function(){var e=this.canvasRef.current;if(!e)throw new Error("Canvas reference error");return e}},{key:"getDownloadButton",value:function(){return this.state.isImageLoaded?r.a.createElement("a",{download:this.props.imageName,href:this.props.dataUrl},r.a.createElement("span",{className:"options__download-icon",title:"Download","aria-label":"Download"},"D")):r.a.createElement("p",null,'"'.concat(this.props.imageName,'"')," not available yet")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"DownloadableImage"},r.a.createElement("div",{className:"DownloadableImage__options"},r.a.createElement("button",{onClick:function(){return e.props.deleteImage(e.props.date)},className:"options__delete-button",title:"Delete","aria-label":"Delete"},"\xd7"),this.getDownloadButton()),r.a.createElement("canvas",{width:this.props.width,height:this.props.height,ref:this.canvasRef,hidden:!0}),r.a.createElement("img",{className:"DownloadableImage__image",src:this.props.dataUrl,alt:this.props.alt,width:this.props.width,height:this.props.height,onLoad:this.onImageLoad,ref:this.imageRef}))}}]),t}(n.Component)),A=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(I.a)(this,(e=Object(R.a)(t)).call.apply(e,[this].concat(o)))).createPhotoListItem=function(e,t){var n=e.blob,o=e.width,i=e.height,s=e.date,l=URL.createObjectURL(n);return r.a.createElement("li",{key:t,className:"result-container"},r.a.createElement(U,{dataUrl:l,width:o,height:i,alt:String(t),imageName:String(t),date:s,deleteImage:a.props.deleteImage}))},a}return Object(O.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return r.a.createElement("ul",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexWrap:"wrap"}},this.props.imageData.map(this.createPhotoListItem))}}]),t}(n.Component),H=a(35),B="image_data",F=a.n(H).a.open("StyleTransfer",1,function(e){e.createObjectStore(B,{keyPath:"date"})});function G(e){return F.then(function(t){return t.transaction(B,"readwrite").objectStore(B).put(e)})}a(58);var V=a(36),Y=a.n(V),q=[{name:"Scream",pathToModel:"models/scream",pathToImage:"img/styles/Munch_TheScream_Wikipedia.jpg"},{name:"The Wave",pathToModel:"models/wave",pathToImage:"img/styles/Wave_Hokusai_Wikipedia.jpg"},{name:"Rain Princess",pathToModel:"models/rain_princess",pathToImage:"img/styles/RainPrincess_LeonidAfremov_Deviantart.jpg"},{name:"Matrix",pathToModel:"models/matrix",pathToImage:"img/styles/Matrix_Pixabay_Comfreak.jpg"},{name:"Starry Night",pathToModel:"models/starry_night",pathToImage:"img/styles/StarryNight_VanGogh_Wikipedia.jpg"},{name:"Mosaic",pathToModel:"models/mosaic",pathToImage:"img/styles/mosaic.jpg"}],z=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(I.a)(this,(e=Object(R.a)(t)).call.apply(e,[this].concat(r)))).state={imageData:[],styleTransfer:null,selectedStyle:"None",loadingStyle:!1},a._deleteImage=function(e){!function(e){F.then(function(t){return t.transaction(B,"readwrite").objectStore(B).delete(e)})}(e),a.setState(function(t){return{imageData:t.imageData.filter(function(t){return t.date!==e})}})},a._onNewPhoto=function(){var e=Object(k.a)(N.a.mark(function e(t){var n,r,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=M(t),r=W(n),t instanceof HTMLImageElement&&(t.width=C.width,t.height=C.height),a.state.styleTransfer){e.next=7;break}a._loadImage(t,r),e.next=11;break;case 7:return e.next=9,a.state.styleTransfer.transfer(t);case 9:(o=e.sent).complete?a._loadImage(o,r):o.addEventListener("load",a._loadImage.bind(Object(x.a)(Object(x.a)(a)),o,r),{once:!0});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._onImageInputted=function(e){var t=e.target;if(t.files&&1===t.files.length){var n=t.files[0],r=new Image,o=URL.createObjectURL(n);r.src=o,r.onload=Object(k.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:URL.revokeObjectURL(o),a._onNewPhoto(r);case 2:case"end":return e.stop()}},e,this)})),t.value=""}},a._onStyleSelection=function(){var e=Object(k.a)(N.a.mark(function e(t,n){var r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loadingStyle:!0}),e.next=3,Y.a.styleTransfer(n);case 3:r=e.sent,a.setState({styleTransfer:r,selectedStyle:t,loadingStyle:!1});case 5:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(O.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this;F.then(function(e){return e.transaction(B,"readonly").objectStore(B).getAll()}).then(function(t){return e.setState({imageData:t})})}},{key:"_loadImage",value:function(){var e=Object(k.a)(N.a.mark(function e(t,a){var n,r,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t,a);case 2:n=e.sent,r=Date.now(),G(o=Object(w.a)({date:r,blob:n},a)),this.setState(function(e){return{imageData:[].concat(Object(_.a)(e.imageData),[o])}});case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"centered"},this.state.loadingStyle&&r.a.createElement("div",{className:"loading-style-info"},"Loading Style"),r.a.createElement("h2",null,"Select the style to apply"),r.a.createElement("ul",{className:"style-list"},r.a.createElement("li",null,r.a.createElement("label",{className:"style-list__style-option ".concat("None"===this.state.selectedStyle?"style-list__style-option--selected":"")},r.a.createElement("div",{className:"style-option__img--none"}),r.a.createElement("button",{className:"style-option__btn",onClick:function(){return e.setState({styleTransfer:null,selectedStyle:"None",loadingStyle:!1})}},"None"))),q.map(function(t){var a=t.name,n=t.pathToImage,o=t.pathToModel;return r.a.createElement("li",{key:a},r.a.createElement("label",{className:"style-list__style-option ".concat(e.state.selectedStyle===a?"style-list__style-option--selected":"")},r.a.createElement("img",{className:"style-option__img",src:n,alt:'Image of the "'.concat(a,'" style')}),r.a.createElement("button",{className:"style-option__btn",onClick:function(){return e._onStyleSelection(a,o)},disabled:e.state.loadingStyle},a)))})),r.a.createElement("h2",null,"Take a picture or choose an image from your device"),r.a.createElement("section",{className:"input-section"},r.a.createElement(P,{onNewPhoto:this._onNewPhoto}),r.a.createElement("label",{className:"input-section__file-input"},r.a.createElement("input",{disabled:this.state.loadingStyle,type:"file",accept:"image/*",multiple:!1,onChange:this._onImageInputted,style:{display:"none"}}),"Open image from disk")),r.a.createElement("h2",null,"Results"),0===this.state.imageData.length?r.a.createElement("p",null,"No images available"):r.a.createElement(A,{imageData:this.state.imageData,deleteImage:this._deleteImage}))}}]),t}(n.Component),J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function $(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var K=a(18),Q=a(21),X=a(16),Z=r.a.createElement(K.a,{basename:"/StyleTransfer"},r.a.createElement(Q.a,null,r.a.createElement(X.a,{exact:!0,path:"/",component:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"container"},r.a.createElement(c,null),r.a.createElement("span",{"aria-hidden":"true",className:"header__down-arrow-container"},r.a.createElement("span",{className:"down-arrow-container__arrow"},"\u2304")))),r.a.createElement("main",null,r.a.createElement("section",{id:"about-section",className:"container section"},r.a.createElement("h2",{className:"centered-message"},"What is Stransfer?"),r.a.createElement("p",{className:"centered-message"},"Stransfer is a web application that lets you take pictures and apply a style to them. It was made by students as part of a college project using the"," ",r.a.createElement("a",{className:"inline-link",href:"https://ml5js.org/",target:"_blank",rel:"noopener noreferrer"},"ml5js")," ","library."),r.a.createElement("ul",{className:"features"},r.a.createElement("li",{className:"features__card"},r.a.createElement("p",{className:"card__message"},"You can take photos within the app and apply astonishing styles to them"),r.a.createElement("img",{className:"card_img",src:u.a,alt:"Cartoon person painting herself in a canvas with a different style"})),r.a.createElement("li",{className:"features__card"},r.a.createElement("p",{className:"card__message"},"You can also upload images from your device"),r.a.createElement("img",{className:"card_img",src:h.a,alt:"Cartoon person uploading physical files to a cardboard imitating the browser"})),r.a.createElement("li",{className:"features__card"},r.a.createElement("p",{className:"card__message"},"And everything is done in your browser, your photos never leave your device"),r.a.createElement("img",{className:"card_img",src:f.a,alt:"Cartoon image of three browser windows secured with a lock"})))),r.a.createElement("section",{id:"about-us-section",className:"container section"},r.a.createElement("h2",{className:"centered-message"},"Who are we?"),r.a.createElement("ul",{className:"our-information"},r.a.createElement("li",{className:"our-information__info-container"},r.a.createElement("img",{className:"info-container__img",src:y.a,alt:"Image of co-author with the 'rain princess' style"}),r.a.createElement("p",{className:"info-container__info"},"My name is Daute and I enjoy creating useful and interesting applications like this. You can find me"," ",r.a.createElement("a",{className:"inline-link",href:"https://github.com/DauteRR",target:"_blank",rel:"noopener noreferrer"},"@DauteRR on Github"))),r.a.createElement("li",{className:"our-information__info-container"},r.a.createElement("img",{className:"info-container__img",src:v.a,alt:"Image of co-author with the 'mosaic' style"}),r.a.createElement("p",{className:"info-container__info"},"I'm Carlos, I love Software Development and understanding the interesting maths behind Artificial Intelligence techniques. You can find me"," ",r.a.createElement("a",{className:"inline-link",href:"https://github.com/carlosdg",target:"_blank",rel:"noopener noreferrer"},"@carlosdg on Github")))),r.a.createElement("p",{className:"centered-message"},"We are students at"," ",r.a.createElement("a",{className:"inline-link",href:"https://www.ull.es/en/",target:"_blank",rel:"noopener noreferrer"},"ULL")," ","where this app was born as part of a project for the"," ",r.a.createElement("q",null,"Intelligent Systems")," subject. We decided to do a web application so anyone can enjoy it, hope you like it \ud83d\ude0a")),r.a.createElement("section",{id:"go-to-app-section",className:"container section"},r.a.createElement(s.a,{className:"go-to-app-link",to:"/app"},"Go to the application"),r.a.createElement("p",{className:"style-selection-caveats"},"But before using the app"," ",r.a.createElement("strong",null,"please read the following caveats that it has right now:")),r.a.createElement("ul",{className:"caveats-list"},r.a.createElement("li",null,"Once you click on a style it will be downloaded. They are about 17MB each \ud83d\ude31 but after the first download they are stored in browser for later use (including offline use)"),r.a.createElement("li",null,"The computation needed is considerably high and the app will freeze or lag until the style is applied"),r.a.createElement("li",null,"Doesn't work on Safari nor iOS \ud83d\ude14"),r.a.createElement("li",null,"For performance reasons the style is not displayed on the camera in real time"),r.a.createElement("li",null,"For performance reasons too the size of the photos is considerably low")))))}}),r.a.createElement(X.a,{path:"/app",component:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("div",{style:{backgroundColor:"#6c63ff",boxShadow:"2px 2px 10px #636cff"}},r.a.createElement("div",{className:"container"},r.a.createElement(c,null))),r.a.createElement("div",{className:"container"},r.a.createElement(z,null)))}}),r.a.createElement(X.a,{component:function(){return r.a.createElement("div",null,"Error")}})));i.a.render(Z,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/StyleTransfer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/StyleTransfer","/service-worker.js");J?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):$(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):$(t,e)})}}()}},[[37,2,1]]]);
//# sourceMappingURL=main.a3e1b919.chunk.js.map