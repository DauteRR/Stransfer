(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,a){e.exports=a.p+"static/media/undraw_artificial_intelligence_upfn.2b0a5c21.svg"},31:function(e,t,a){e.exports=a.p+"static/media/undraw_making_art_759c.7a6edf59.svg"},32:function(e,t,a){e.exports=a.p+"static/media/undraw_safe_bnk7.c0bcd0b8.svg"},35:function(e,t,a){e.exports=a(58)},41:function(e,t,a){},46:function(e,t,a){},48:function(e,t,a){},52:function(e,t,a){},54:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(29),i=a.n(o),s=(a(41),a(6)),c=a(20),l=(a(46),function(){return r.a.createElement("nav",{className:"header__nav"},r.a.createElement(c.HashLink,{to:"/"},r.a.createElement("h1",{className:"nav__logo"},"Stransfer")),r.a.createElement("div",{className:"collapsable-nav-list"},r.a.createElement("input",{type:"checkbox",id:"collapse-nav",hidden:!0}),r.a.createElement("label",{"aria-hidden":"true",className:"collapse-nav-list-btn",htmlFor:"collapse-nav"},r.a.createElement("span",null)," ",r.a.createElement("span",null)," ",r.a.createElement("span",null)),r.a.createElement("ul",{className:"nav__nav-list"},r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement(c.HashLink,{to:"/#about-section"},"About Stransfer")),r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement(c.HashLink,{to:"/app"},"App")),r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement(c.HashLink,{to:"/#about-us-section"},"About Us")),r.a.createElement("li",{className:"nav-list__nav-item"},r.a.createElement("a",{href:"https://github.com/DauteRR/StyleTransfer",target:"_blank",rel:"noopener noreferrer"},"Github")))))}),m=(a(48),a(31)),u=a.n(m),d=a(32),h=a.n(d),p=a(26),f=a.n(p),g=a(23),v=a(24),b=a(9),y=a.n(b),_=a(15),w=a(10),E=a(11),N=a(14),k=a(12),j=a(13),S=a(19),x=document.createElement("canvas");function I(e,t){var a=t.width,n=t.height;x.width=a,x.height=n;var r=x.getContext("2d");return r?(r.drawImage(e,0,0,a,n),new Promise(function(e,t){return x.toBlob(function(a){return a?e(a):t()})})):Promise.reject()}function O(e,t){try{t.srcObject=e}catch(a){t.src=URL.createObjectURL(e)}finally{return new Promise(function(e){return t.addEventListener("loadedmetadata",function(){return e(t)},{once:!0})})}}function R(e){if(e.videoWidth>0&&e.videoHeight>0)return e.videoWidth/e.videoHeight;throw new Error("Invalid dimensions {videoWidth: ".concat(e.videoWidth,", videoHeight: ").concat(e.videoHeight,"}. They must be numbers greater than 0"))}var T={width:300,height:300};function C(e){var t=Object(v.a)({},T);return e<1?t.width*=e:t.height/=e,t}a(52);var D=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(N.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).state={stream:null,isRecording:!1,errorMessage:""},a._videoRef=null,a._setVideoRef=function(e){return a._videoRef=e},a._loadStream=function(){var e=Object(_.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a._videoRef){e.next=6;break}return e.next=3,O(t,a._videoRef);case 3:a.setState({stream:t,isRecording:!0,errorMessage:""}),e.next=7;break;case 6:a.setState({stream:null,isRecording:!1,errorMessage:"Unable to get the video element. Must be a bug, this should never happen D:"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._takePhoto=Object(_.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a._videoRef,a.state.isRecording&&t){e.next=3;break}return e.abrupt("return",Promise.reject());case 3:a.props.onNewPhoto(t);case 4:case"end":return e.stop()}},e,this)})),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(this._loadStream).catch(function(t){e.setState({isRecording:!1,errorMessage:"Access to camera not granted"})})}},{key:"componentWillUnmount",value:function(){var e=this.state.stream;e&&function(e){Object(g.a)(e.getTracks()).forEach(function(e){return e.stop()})}(e)}},{key:"render",value:function(){if(this.state.errorMessage)return r.a.createElement("div",{className:"camera-container"},r.a.createElement("p",{className:"camera-container__error-message"},this.state.errorMessage));var e=T;this._videoRef&&this._videoRef.videoWidth>0&&this._videoRef.videoHeight>0&&(e=C(R(this._videoRef)));return r.a.createElement("div",{className:"camera-container"},r.a.createElement("div",{className:"camera-container__camera"},r.a.createElement("video",{ref:this._setVideoRef,autoPlay:!0,width:T.width,height:T.height,role:"application","aria-label":"Camera",style:{maxWidth:"".concat(e.width,"px"),maxHeight:"".concat(e.height,"px")}},'Cannot show the camera. Maybe it is because this browser doesn\'t support the HTML5 "video" element')),r.a.createElement("button",{className:"camera-container__button",onClick:this._takePhoto,"aria-label":"Take photo",title:"Take photo"}))}}]),t}(n.Component),L=(a(54),function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(N.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).canvasRef=r.a.createRef(),a.imageRef=r.a.createRef(),a.state={isImageLoaded:!1},a.onImageLoad=function(){var e=a.getCanvasElement().getContext("2d");e&&(e.drawImage(a.getImageElement(),0,0,a.props.width,a.props.height),a.setState({isImageLoaded:!0}))},a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"getImageElement",value:function(){var e=this.imageRef.current;if(!e)throw new Error("Image reference error");return e}},{key:"getCanvasElement",value:function(){var e=this.canvasRef.current;if(!e)throw new Error("Canvas reference error");return e}},{key:"getDownloadButton",value:function(){return this.state.isImageLoaded?r.a.createElement("a",{download:this.props.imageName,href:this.props.dataUrl},r.a.createElement("span",{className:"options__download-icon",title:"Download","aria-label":"Download"},"D")):r.a.createElement("p",null,'"'.concat(this.props.imageName,'"')," not available yet")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"DownloadableImage"},r.a.createElement("div",{className:"DownloadableImage__options"},r.a.createElement("button",{onClick:function(){return e.props.deleteImage(e.props.date)},className:"options__delete-button",title:"Delete","aria-label":"Delete"},"\xd7"),this.getDownloadButton()),r.a.createElement("canvas",{width:this.props.width,height:this.props.height,ref:this.canvasRef,hidden:!0}),r.a.createElement("img",{className:"DownloadableImage__image",src:this.props.dataUrl,alt:this.props.alt,width:this.props.width,height:this.props.height,onLoad:this.onImageLoad,ref:this.imageRef}))}}]),t}(n.Component)),M=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(N.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).createPhotoListItem=function(e,t){var n=e.blob,o=e.width,i=e.height,s=e.date,c=URL.createObjectURL(n);return r.a.createElement("li",{key:t,className:"result-container"},r.a.createElement(L,{dataUrl:c,width:o,height:i,alt:String(t),imageName:String(t),date:s,deleteImage:a.props.deleteImage}))},a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return r.a.createElement("ul",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexWrap:"wrap"}},this.props.imageData.map(this.createPhotoListItem))}}]),t}(n.Component),W=a(33),P="image_data",A=a.n(W).a.open("StyleTransfer",1,function(e){e.createObjectStore(P,{keyPath:"date"})});function U(e){return A.then(function(t){return t.transaction(P,"readwrite").objectStore(P).put(e)})}a(56);var H=a(34),q=a.n(H),B=[{name:"Scream",pathToModel:"models/scream",pathToImage:"img/styles/Munch_TheScream_Wikipedia.jpg"},{name:"The Wave",pathToModel:"models/wave",pathToImage:"img/styles/Wave_Hokusai_Wikipedia.jpg"},{name:"Rain Princess",pathToModel:"models/rain_princess",pathToImage:"img/styles/RainPrincess_LeonidAfremov_Deviantart.jpg"},{name:"Matrix",pathToModel:"models/matrix",pathToImage:"img/styles/Matrix_Pixabay_Comfreak.jpg"},{name:"Starry Night",pathToModel:"models/starry_night",pathToImage:"img/styles/StarryNight_VanGogh_Wikipedia.jpg"},{name:"Mosaic",pathToModel:"models/mosaic",pathToImage:"img/styles/mosaic.jpg"}],F=function(e){function t(){var e,a;Object(w.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(N.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).state={imageData:[],styleTransfer:null,selectedStyle:"None",loadingStyle:!1},a._deleteImage=function(e){!function(e){A.then(function(t){return t.transaction(P,"readwrite").objectStore(P).delete(e)})}(e),a.setState(function(t){return{imageData:t.imageData.filter(function(t){return t.date!==e})}})},a._onNewPhoto=function(){var e=Object(_.a)(y.a.mark(function e(t){var n,r,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state.loadingStyle){e.next=2;break}return e.abrupt("return");case 2:if(n=R(t),r=C(n),a.state.styleTransfer){e.next=8;break}a._loadImage(t,r),e.next=12;break;case 8:return e.next=10,a.state.styleTransfer.transfer(t);case 10:(o=e.sent).complete?a._loadImage(o,r):o.addEventListener("load",a._loadImage.bind(Object(S.a)(Object(S.a)(a)),o,r),{once:!0});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a._onStyleSelection=function(){var e=Object(_.a)(y.a.mark(function e(t,n){var r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loadingStyle:!0}),e.next=3,q.a.styleTransfer(n);case 3:r=e.sent,a.setState({styleTransfer:r,selectedStyle:t,loadingStyle:!1});case 5:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;A.then(function(e){return e.transaction(P,"readonly").objectStore(P).getAll()}).then(function(t){return e.setState({imageData:t})})}},{key:"_loadImage",value:function(){var e=Object(_.a)(y.a.mark(function e(t,a){var n,r,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t,a);case 2:n=e.sent,r=Date.now(),U(o=Object(v.a)({date:r,blob:n},a)),this.setState(function(e){return{imageData:[].concat(Object(g.a)(e.imageData),[o])}});case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"centered"},this.state.loadingStyle&&r.a.createElement("div",{className:"loading-style-info"},"Downloading Style"),r.a.createElement("p",{className:"about-style-selection"},"Select below the style to apply to the photo to take. But before doing so,"," ",r.a.createElement("strong",null,"please read the following caveats that the app has right now:")),r.a.createElement("ul",{className:"caveats-list"},r.a.createElement("li",null,"Once you click on a style it will be downloaded. They are about 17MB each \ud83d\ude31 and they are currently not cached \ud83d\ude05"),r.a.createElement("li",null,"For performance reasons the style is not displayed on the camera on real time"),r.a.createElement("li",null,"For performance reasons too the size and quality of the photos is considerably low")),r.a.createElement("ul",{className:"style-list"},r.a.createElement("li",null,r.a.createElement("label",{className:"style-list__style-option ".concat("None"===this.state.selectedStyle?"style-list__style-option--selected":"")},r.a.createElement("div",{className:"style-option__img--none"}),r.a.createElement("button",{className:"style-option__btn",onClick:function(){return e.setState({styleTransfer:null,selectedStyle:"None",loadingStyle:!1})}},"None"))),B.map(function(t){var a=t.name,n=t.pathToImage,o=t.pathToModel;return r.a.createElement("li",{key:a},r.a.createElement("label",{className:"style-list__style-option ".concat(e.state.selectedStyle===a?"style-list__style-option--selected":"")},r.a.createElement("img",{className:"style-option__img",src:n,alt:'Image of the "'.concat(a,'" style')}),r.a.createElement("button",{className:"style-option__btn",onClick:function(){return e._onStyleSelection(a,o)}},a)))})),r.a.createElement(D,{onNewPhoto:this._onNewPhoto}),r.a.createElement(M,{imageData:this.state.imageData,deleteImage:this._deleteImage}))}}]),t}(n.Component),G=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function V(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var J=a(8),z=a(28),Y=a(7),$=r.a.createElement(J.a,{basename:"/StyleTransfer"},r.a.createElement(z.a,null,r.a.createElement(Y.a,{exact:!0,path:"/",component:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"container"},r.a.createElement(l,null),r.a.createElement("span",{"aria-hidden":"true",className:"header__down-arrow-container"},r.a.createElement("span",{className:"down-arrow-container__arrow"},"\u2304")))),r.a.createElement("main",null,r.a.createElement("section",{id:"about-section",className:"container section"},r.a.createElement("h2",{className:"centered-message"},"What is Stransfer?"),r.a.createElement("p",{className:"centered-message"},"Stransfer is a web application that lets you take pictures and apply a style to them. It was made by students as part of a college project using the"," ",r.a.createElement("a",{className:"inline-link",href:"https://ml5js.org/",target:"_blank",rel:"noopener noreferrer"},"ml5js")," ","library."),r.a.createElement("ul",{className:"features"},r.a.createElement("li",{className:"features__card"},r.a.createElement("p",{className:"card__message"},"You can take photos within the app and apply astonishing styles to them"),r.a.createElement("img",{className:"card_img",src:u.a,alt:"Cartoon person painting herself in a canvas with a different style"})),r.a.createElement("li",{className:"features__card"},r.a.createElement("p",{className:"card__message"},"And everything is done in your browser, your photos never leave your device"),r.a.createElement("img",{className:"card_img",src:h.a,alt:"Cartoon image of three browser windows secured with a lock"})))),r.a.createElement("section",{id:"about-us-section",className:"container section"},r.a.createElement("h2",{className:"centered-message"},"Who are we?"),r.a.createElement("ul",{className:"our-information"},r.a.createElement("li",{className:"our-information__info-container"},r.a.createElement("img",{className:"info-container__img",src:f.a,alt:"Cartoon robot"}),r.a.createElement("p",{className:"info-container__info"},"Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequatur placeat assumenda quibusdam hic aliquid culpa quae odit exercitationem velit dicta alias accusantium, laborum porro veniam molestiae optio nisi, obcaecati eligendi?")),r.a.createElement("li",{className:"our-information__info-container"},r.a.createElement("img",{className:"info-container__img",src:f.a,alt:"Cartoon robot"}),r.a.createElement("p",{className:"info-container__info"},"Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequatur placeat assumenda quibusdam hic aliquid culpa quae odit exercitationem velit dicta alias accusantium, laborum porro veniam molestiae optio nisi, obcaecati eligendi?"))),r.a.createElement("p",{className:"centered-message"},"We are students at"," ",r.a.createElement("a",{className:"inline-link",href:"https://www.ull.es/en/",target:"_blank",rel:"noopener noreferrer"},"ULL")," ","where this app was born as part of a project for the"," ",r.a.createElement("q",null,"Intelligent Systems")," subject. We decided to do a web application so anyone can enjoy it, hope you like it \ud83d\ude0a")),r.a.createElement("section",{id:"go-to-app-section",className:"container section"},r.a.createElement(s.a,{className:"go-to-app-link",to:"/app"},"Go to the application"))))}}),r.a.createElement(Y.a,{path:"/app",component:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("div",{style:{backgroundColor:"#6c63ff",boxShadow:"2px 2px 10px #636cff"}},r.a.createElement("div",{className:"container"},r.a.createElement(l,null))),r.a.createElement("div",{className:"container"},r.a.createElement(F,null)))}}),r.a.createElement(Y.a,{component:function(){return r.a.createElement("div",null,"Error")}})));i.a.render($,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/StyleTransfer",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/StyleTransfer","/service-worker.js");G?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):V(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):V(t,e)})}}()}},[[35,2,1]]]);
//# sourceMappingURL=main.f1e39fee.chunk.js.map